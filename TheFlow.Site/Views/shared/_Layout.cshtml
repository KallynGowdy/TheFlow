@using System.Web.Optimization
@using BootstrapSupport
@using NavigationRoutes

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>@ViewBag.Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    @*<link rel="stylesheet" href="~/Content/foundation/normalize.css" />
    <link rel="stylesheet" href="~/Content/foundation/foundation.css" />*@
    <link href="~/Content/uikit/uikit.css" rel="stylesheet" />
    <link href="~/Content/Styles.css" rel="stylesheet" />
    @RenderSection("head", required: false)
    @Html.Partial("_html5shiv")

    @* favicons and touch icons go here *@

</head>
<body>
    <nav class="uk-navbar uk-navbar-attached" role="navigation">
        <a class="uk-navbar-brand" href="~/">TheFlow</a>
        <ul class="uk-navbar-nav uk-hidden-small">
            <li><a href="~/">Home</a></li>
            <li><a href="~/Develop">Develop</a></li>
            <li><a href="~/Questions">Questions</a></li>
            @{var navbarLeftSection = RenderSection("NavBarLeft", false);
              string navbarLeft = "";
              if (navbarLeftSection != null)
              {
                  navbarLeft = navbarLeftSection.ToHtmlString();
              }}
            @Html.Raw(navbarLeft)
            <li class="uk-nav-divider"></li>
        </ul>
        <div class="uk-navbar-flip uk-hidden-small">
            <ul class="uk-navbar-nav">
                <li class="uk-nav-divider"></li>
                @{TheFlow.Api.Entities.User user = TheFlow.Site.Controllers.ControllerHelper.Authenticate(Request);}

                @if (user == null)
                {
                    <li><a href="~/Users/LogIn">Create Account</a></li>
                    <li>@Html.ActionLink("Log In", "LogIn", "Users")</li>
                }
                else
                {
                    <li class="uk-parent">
                        @Html.ActionLink(user.DisplayName, "Info", "Users", new { user = user.DisplayName }, null)
                        <div class="uk-dropdown uk-dropdown-navbar">
                            <ul class="uk-nav uk-nav-navbar">
                                <li>
                                    @Html.ActionLink("Log Out", "LogOut", "Users")
                                </li>
                                <li class="has-dropdown">
                                    @Html.ActionLink("Account", "Info", "Users")
                                    <ul class="dropdown">
                                        <li>
                                            @Html.ActionLink("Edit", "Edit", "Users")
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </li>
                        
                    <li>@Html.ActionLink(user.Reputation.ToString(), "Reputation", "Account", new { title = string.Format("{0} Reputation", user.Reputation.ToString()) })</li>
                }
                @{var navbarRightSection = RenderSection("NavBarRight", false);
                  string navbarRight = "";
                  if (navbarRightSection != null)
                  {
                      navbarRight = navbarRightSection.ToHtmlString();
                  }}
                @Html.Raw(navbarRight)
            </ul>
        </div>
        <a href="mobile-sidebar" class="uk-navbar-toggle uk-float-right uk-visible-small" data-uk-offcanvas="{target: '#mobile-sidebar'}"></a>
    </nav>
    <div id="mobile-sidebar" class="uk-offcanvas">
        <div class="uk-offcanvas-bar uk-offcanvas-bar-flip">
            <ul class="uk-nav uk-nav-offcanvas uk-nav-parent-icon">
                <li><a href="~/">Home</a></li>
                <li><a href="~/Develop">Develop</a></li>
                <li><a href="~/Questions">Questions</a></li>
                @Html.Raw(navbarLeft)
                <li class="uk-nav-divider"></li>

                @if (user == null)
                {
                    <li><a href="~/Users/LogIn">Create Account</a></li>
                    <li>@Html.ActionLink("Log In", "LogIn", "Users")</li>
                }
                else
                {
                    <li class="uk-parent">
                        @Html.ActionLink(user.DisplayName, "Info", "Users", new { user = user.DisplayName }, null)
                        <div class="uk-dropdown uk-dropdown-navbar">
                            <ul class="uk-nav uk-nav-navbar">
                                <li>
                                    @Html.ActionLink("Log Out", "LogOut", "Users")
                                </li>
                                <li class="has-dropdown">
                                    @Html.ActionLink("Account", "Info", "Users")
                                    <ul class="dropdown">
                                        <li>
                                            @Html.ActionLink("Edit", "Edit", "Users")
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </li>                        
                    <li>@Html.ActionLink(user.Reputation.ToString(), "Reputation", "Account", new { title = string.Format("{0} Reputation", user.Reputation.ToString()) })</li>
                }
                @Html.Raw(navbarRight)
            </ul>
        </div>
    </div>
    <div class="uk-container uk-container-center main-content">
        <div class="uk-grid" data-uk-grid-margin>
            <div class="uk-width-1-1">
                @Html.Partial("_validationSummary")
                @RenderBody()
                <hr>
            </div>
        </div>
        <footer class="uk-margin-top">
            <div class="uk-grid">
                <div class="uk-width-medium-1-2">
                    <p class="uk-hidden-small uk-text-left Copyright"></p>
                    <p class="uk-visible-small uk-text-center Copyright"></p>
                </div>
                <div class="uk-width-medium-1-2">
                    <p class="uk-hidden-small uk-text-right Time"></p>
                    <p class="uk-visible-small uk-text-center Time"></p>
                </div>
            </div>
        </footer>
    </div>


    @* A form that includes an anti-forgery token that is used for ajax requests *@
    <form id="__AjaxAntiForgeryForm" style="height: 0px; width: auto; padding: 0px 0px 0px 0px; margin: 0 0 0 0;" method="post" action="#">
        @Html.AntiForgeryToken()
    </form>

    @*<script src="~/scripts/custom.modernizr.js"></script>*@
    @*<script>
        document.write('<script src=' +
        ('__proto__' in {} ? '/TheFlow/scripts/zepto' : 'TheFlow/scripts/jquery-2.0.3') +
        '.js><\/script>')
    </script>*@
    <script src="~/scripts/jquery-2.0.3.js"></script>
    <script src="~/scripts/uikit.js"></script>
    @*<script src="~/scripts/foundation.min.js"></script>*@
    <script src="~/scripts/moment.js"></script>
    @RenderSection("Scripts", required: false)
    <script>
        $(function () {
            //$(document).foundation();
            @RenderSection("OnPageLoadFunction", required: false)
        });
        setInterval(function () {
            $(".Time").text(moment().format("dddd, MMMM Do YYYY, h:mm:ss a"));
            $(".Copyright").text("© Your Company " + moment().format("YYYY"));
            @RenderSection("TimeUpdateFunction", required: false)
        }, 1000);
    </script>
</body>
</html>
